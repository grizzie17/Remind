/*---------------------------------------------------------------------+\|																		||				Copyright 1986 .. 1997 Grizzly Software					||					a division of Bear Consulting Group					||						  All Rights Reserved							||																		||	This software-file/document, in whole or in part, including			||	the structures and the procedures described herein, may not			||	be provided or otherwise made available without prior written		||	authorization.  In case of authorized or unauthorized				||	publication or duplication, copyright is claimed.					||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\||	lunar.cpp  --  brief description of what lunar.cpp is for||	Purpose:|	Author and Date:	J.Griswold			dd-mmm-1995|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\||	Revision History:|	dd-mmm-1995			J.Griswold		Initial Revision|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	Include Files														||																		|\+---------------------------------------------------------------------*///#include "stdafx.h"		// must be first include for MFC#include <math.h>#include "datevalu.h"#include "lunar.h"/*---------------------------------------------------------------------+\|																		||	Local defines / constants											||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	Local Type Definitions												||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	Private Global Variables											||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	Public Global Variables												||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	External Variables													||																		|\+---------------------------------------------------------------------*//*=====================================================================+\||																		|||	 Code																|||																		|\+=====================================================================*//*---------------------------------------------------------------------+\ *  NAME:	 flmoon - calculate the full/new moon *  DESCRIPTION: *  AUTHOR: first lastName		DATE:	dd-mmm-1993\+---------------------------------------------------------------------*/long	flmoon		(		int		n,		/* number of moon phases since 1-jan-1900 */		int		nph,	/* phase: 0=new, 1=1st quarter, 2=full, 3=last */		long*	jd,		double*	frac		){	const double RAD = (PI/180.0);	int		i;	double	am,as,c,t,t2,xtra;	long	jdate;		c = (double)n + (double)nph / 4.0;	t = c / 1236.85;	t2 = t * t;	as = 359.2242 + 29.10535608 * c;	am = 306.0253 + 385.81691806 * c + 0.0107306 * t2;	jdate = 2415020L + 28L * (long)n + 7L * nph;	xtra = 0.75933 + 1.53058868 * c + ( 1.178e-4 - 1.55e-7 * t ) * t2;	switch( nph )	{	case 0:	case 2:		xtra += ( 0.1734 - 3.93e-4 * t ) * sin( RAD * as ) 				- 0.4068 * sin( RAD * am );		break;	case 1:	case 3:		xtra += ( 0.1721 - 4.0e-4 * t ) * sin( RAD * as )				- 0.6280 * sin( RAD * am );		break;	}	i = ( xtra >= 0.0 ? (int)floor( xtra ) : (int)ceil( xtra - 1.0 ) );	*jd = jdate + (long)i;	*frac = xtra - (double)i;	return (long)((double)jdate + xtra + 0.5 - ((double)dateValue_timezone()/24.0) );}/*---------------------------------------------------------------------+\ *  NAME:	 someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	dd-mmm-1995\+---------------------------------------------------------------------*/