/*---------------------------------------------------------------------+\|																		||				Copyright 1986 .. 1997 Grizzly Software					||					a division of Bear Consulting Group					||						  All Rights Reserved							||																		||	This software-file/document, in whole or in part, including			||	the structures and the procedures described herein, may not			||	be provided or otherwise made available without prior written		||	authorization.  In case of authorized or unauthorized				||	publication or duplication, copyright is claimed.					||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\||	remabout.cpp  --  brief description of what remabout.cpp is for||	Purpose:|	Author and Date:	J.Griswold			30-Jun-1995|| optional topics (delete if not used)|	Usage:|	Restrictions/Warnings:|	Algorithms/Formats:|	References:|	Notes:|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\||	Revision History:|	31-Dec-1996			J.Griswold		Change copyright year string in about box to 1997.	01-Jan-1996			J.Griswold		Change copyright year string in about box to 1996.		12-Sep-1995			J.Griswold		Add function that creates the window for you and then forces		the initial update.		30-Jun-1995			J.Griswold		Initial Revision|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	Include Files														||																		|\+---------------------------------------------------------------------*/#include "machine.h"#if ! defined( OS_MACINTOSH )#	error "This file is only available for the Macintosh"#endif#include <LowMem.h>#include <types.h>#include <PP_Messages.h>#include "bearstr.h"#include "remabout.h"#include "remcmds.h"#include "xpappl.h"/*---------------------------------------------------------------------+\|																		||	Local defines / constants											||																		|\+---------------------------------------------------------------------*/#define INHERITED	LDialogBox/*---------------------------------------------------------------------+\|																		||	Local Type Definitions												||																		|\+---------------------------------------------------------------------*/class AboutPix : public XPSpritePix{public:					AboutPix();	virtual			~AboutPix();public:	void			setTrip( Point* pStart, Point* pEnd, short nStep = 2 );protected:	virtual void	copyImage							(							GrafPtr inDestPort,							const Rect &inDestRect,							Int16 inXferMode = srcCopy,							RgnHandle inMaskRegion = nil							);		Point	vStart;		// upper-left	Point	vEnd;		//	ditto	Point	vApply;		// point to apply	short	vDelta;		// delta moves between start and end	Bool	vHoriz;		// horizontal movement// ========= overrides ===========public:	virtual Bool	hasFrame( Long nFrame );	virtual void	draw( Rect* pViewRect, Long nFrame );	virtual void	getFrameRect( Rect* pSpriteRect, Rect* pViewRect, Long nFrame );};class AboutPixText : public AboutPix{protected:	virtual void	copyImage							(							GrafPtr inDestPort,							const Rect &inDestRect,							Int16 inXferMode = srcCopy,							RgnHandle inMaskRegion = nil							);};/*---------------------------------------------------------------------+\|																		||	Private Global Variables											||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	Public Global Variables												||																		|\+---------------------------------------------------------------------*//*---------------------------------------------------------------------+\|																		||	External Variables													||																		|\+---------------------------------------------------------------------*/extern "C" void	macVersion_getString		(						/* RTN: status of resource operation */		char*	string			/* OUT:	version string */		);/*=====================================================================+\||																		|||	 Code																|||																		|\+=====================================================================*/#if 0____class____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	21-Nov-1995\+---------------------------------------------------------------------*/AboutPix::AboutPix		(		){	vStart.v = 0;	vStart.h = 0;	vEnd.v = 0;	vEnd.h = 0;	vApply.v = 0;	vApply.h = 0;	vDelta = 0;	vHoriz = NO;}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	21-Nov-1995\+---------------------------------------------------------------------*/AboutPix::~AboutPix		(		){}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	21-Nov-1995\+---------------------------------------------------------------------*/void	AboutPix::setTrip		(		Point*	pStart,		Point*	pEnd,		short	nStep		){	vStart = *pStart;	vEnd = *pEnd;	vApply.v = 0;	vApply.h = 0;		if ( vEnd.v == vStart.v )	{		vHoriz = NO;		vDelta = vStart.h - vEnd.h;		if ( vDelta < 0 )			vDelta *= (-1);		if ( vStart.h < vEnd.h )			vApply.h = nStep;		else			vApply.h = (-nStep);	}	else if ( vEnd.h == vStart.h )	{		vHoriz = YES;		vDelta = vStart.v - vEnd.v;		if ( vDelta < 0 )			vDelta *= (-1);		if ( vStart.v < vEnd.v )			vApply.v = nStep;		else			vApply.v = (-nStep);	}	else	{	}	vDelta /= nStep;	//++vDelta;}/*---------------------------------------------------------------------+\ *  NAME:	copyImage - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	29-Nov-1995\+---------------------------------------------------------------------*/void	AboutPix::copyImage		(		GrafPtr		inDestPort,		const Rect	&inDestRect,		Int16		inXferMode,		RgnHandle	inMaskRegion		){	if ( vpPixWorld )		vpPixWorld->CopyImage( inDestPort, inDestRect, inXferMode, inMaskRegion );}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	21-Nov-1995\+---------------------------------------------------------------------*/Bool	AboutPix::hasFrame		(		Long	nFrame		){	if ( vDelta < nFrame-1 )		return NO;	else		return YES;}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	21-Nov-1995\+---------------------------------------------------------------------*/void	AboutPix::draw		(		Rect*	pViewRect,		Long	nFrame		){	GrafPtr		pPort;	CGrafPtr	pCPort;	Rect		r;	Rect		rSect;	GWorldPtr	pGWorld;	long		ctSeedSave;	getFrameRect( &r, pViewRect, nFrame );		if ( ::SectRect( &r, pViewRect, &rSect ) )	{		::GetPort( &pPort );		pCPort = (CGrafPtr)pPort;		//::ForeColor( blackColor );		//::BackColor( whiteColor );		ctSeedSave = (*(*pCPort->portPixMap)->pmTable)->ctSeed;		pGWorld = vpPixWorld->GetMacGWorld();		(*(*pCPort->portPixMap)->pmTable)->ctSeed				= (*(*pGWorld->portPixMap)->pmTable)->ctSeed;		copyImage( pPort, r );		(*(*pCPort->portPixMap)->pmTable)->ctSeed = ctSeedSave;	}}/*---------------------------------------------------------------------+\ *  NAME:	getFrameRect - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	21-Nov-1995\+---------------------------------------------------------------------*/void	AboutPix::getFrameRect		(		Rect*	pSpriteRect,		Rect*	pViewRect,		Long	nFrame		){	UNREFERENCED_PARAMETER( pViewRect );		if ( vDelta < nFrame )	{		pSpriteRect->top = vEnd.v;		pSpriteRect->left = vEnd.h;	}	else	{		pSpriteRect->top = vStart.v + vApply.v * nFrame;		pSpriteRect->left = vStart.h + vApply.h * nFrame;	}	pSpriteRect->bottom = pSpriteRect->top + vnHeight;	pSpriteRect->right = pSpriteRect->left + vnWidth;}#if 0____class____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	copyImage - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	29-Nov-1995\+---------------------------------------------------------------------*/void	AboutPixText::copyImage		(		GrafPtr		inDestPort,		const Rect	&inDestRect,		Int16		inXferMode,		RgnHandle	inMaskRegion		){	UNREFERENCED_PARAMETER( inXferMode );		if ( vpPixWorld )		vpPixWorld->CopyImage( inDestPort, inDestRect, srcOr, inMaskRegion );}#if 0____class____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	AboutAnim - constructor *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/AboutAnim::AboutAnim		(		void		)		: XPAnimation(){	vnFrame = 0;	vnLogoFrame = 0;	vnIconFrame = 0;	vnPegasusFrame = 0;	vnCopyFrame = 0;	vnVersFrame = 0;	vpLogo = NULL;	vpIcon = NULL;	vpPegasus = NULL;	vpCopy = NULL;	vpVers = NULL;}/*---------------------------------------------------------------------+\ *  NAME:	~AboutAnim - destructor *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/AboutAnim::~AboutAnim		(		void		){	if ( vpLogo )	{		delete vpLogo;		vpLogo = NULL;	}	if ( vpIcon )	{		delete vpIcon;		vpIcon = NULL;	}	if ( vpPegasus )	{		delete vpPegasus;		vpPegasus = NULL;	}	if ( vpCopy )	{		delete vpCopy;		vpCopy = NULL;	}	if ( vpVers )	{		delete vpVers;		vpVers = NULL;	}}/*---------------------------------------------------------------------+\ *  NAME:	getCycle - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	03-Jan-1996\+---------------------------------------------------------------------*/static short		getCycle		(		Point*	pDirect,	// OUT		Rect*	pPort,		Point*	pDest,		Point*	pSize,		short	nRand		){	short	nCycle;		if ( nRand & 1 )	// horiz	{		pDirect->v = 0;		if ( nRand < 0 )	// left			pDirect->h = pPort->right - pDest->h;		else			pDirect->h = -(pDest->h + pSize->h);	}	else // vert	{		pDirect->h = 0;		if ( nRand < 0 )	// up			pDirect->v = (pPort->bottom - pDest->v);		else			pDirect->v = -(pDest->v + pSize->v);	}	if ( pDirect->h )	{		nCycle = pDirect->h;		pDirect->h = (pDirect->h < 0) ? -1: 1;	}	else	{		nCycle = pDirect->v;		pDirect->v = (pDirect->v < 0) ? -1: 1;	}	if ( nCycle < 0 )		nCycle *= -1;	return nCycle;}/*---------------------------------------------------------------------+\ *  NAME:	initialize - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/Bool	AboutAnim::initialize		(		void		){	Bool		result = NO;	GDHandle	hMain;	int			nDepth;	short		nPictID;		typedef struct	{		Point	dist;		Point	end;		Point	direct;		short	nCycle;		short	nStep;	} SpriteInfo;	SpriteInfo	tLogo;	SpriteInfo	tIcon;	SpriteInfo	tPegasus;	SpriteInfo	tCopy;	SpriteInfo	tVers;	short		nMargin;	short		nCycle;	Point		start;	ULong		nSeed;	short		nRand;		do // sequence	{		result = XPAnimation::initialize();		if ( ! result )			break;				result = NO;	// assume failure				::GetDateTime( &nSeed );		LMSetRndSeed( nSeed );		nSeed &= 0x000f;		for ( int i=0; i < nSeed; ++i )			nRand = ::Random();				hMain = GetMainDevice();		nDepth = (**(**hMain).gdPMap).pixelSize;		if ( 8 <= nDepth )			nPictID = 200;		else			nPictID = 201;		vpLogo = buildPix( &tLogo.dist, nPictID );		if ( NULL == vpLogo )			break;				if ( 8 <= nDepth )			nPictID = 202;		else			nPictID = 203;		vpIcon = buildPix( &tIcon.dist, nPictID );		if ( NULL == vpIcon )			break;				if ( 8 <= nDepth )			nPictID = 210;		else			nPictID = 211;		vpPegasus = buildPix( &tPegasus.dist, nPictID );		if ( NULL == vpPegasus )			break;				vpCopy = buildCopyRight( &tCopy.dist );		if ( NULL == vpCopy )			break;				vpVers = buildVers( &tVers.dist );		if ( NULL == vpVers )			break;				nMargin = ((vRect.right - vRect.left) - tLogo.dist.h - tIcon.dist.h) / 3;				nRand = ::Random();		if ( (nRand & 1)  &&  (0 <= nRand) )		{			tIcon.nStep = 3;		//	nRand &= ~0x8001;		}		else		{			tIcon.nStep = 1;		}		tIcon.end.h = vRect.right - nMargin - tIcon.dist.h;		tIcon.end.v = vRect.bottom - nMargin - tIcon.dist.v - tCopy.dist.v - 2;		tIcon.nCycle = getCycle( &tIcon.direct, &vRect, &tIcon.end, &tIcon.dist, nRand )							/ tIcon.nStep;				tLogo.nStep =  (tIcon.nStep == 1) ? 3 : 4;		tLogo.end.h = nMargin;		tLogo.end.v = vRect.bottom - nMargin - tLogo.dist.v - tCopy.dist.v - 2;		tLogo.nCycle = getCycle( &tLogo.direct, &vRect,							&tLogo.end, &tLogo.dist, ::Random() )							/ tLogo.nStep;				tPegasus.nStep = 12;		tPegasus.end.h = vRect.right - tPegasus.dist.h;		tPegasus.end.v = vRect.bottom - tPegasus.dist.v;		tPegasus.nCycle = getCycle( &tPegasus.direct, &vRect, 								&tPegasus.end, &tPegasus.dist, ::Random() ) / tPegasus.nStep;		tVers.nStep = 2;		tVers.end.h = nMargin;		tVers.end.v = nMargin;		tVers.nCycle = getCycle( &tVers.direct, &vRect,								&tVers.end, &tVers.dist, ::Random() ) / tVers.nStep;		tCopy.nStep = 8;		tCopy.end.h = nMargin;		tCopy.end.v = vRect.bottom - tCopy.dist.v - nMargin;		tCopy.nCycle = getCycle( &tCopy.direct, &vRect,								&tCopy.end, &tCopy.dist, ::Random() ) / tCopy.nStep;		nCycle = tLogo.nCycle;		if ( nCycle < tIcon.nCycle )			nCycle = tIcon.nCycle;		if ( nCycle < tPegasus.nCycle )			nCycle = tPegasus.nCycle;		if ( nCycle < tCopy.nCycle )			nCycle = tCopy.nCycle;		if ( nCycle < tVers.nCycle )			nCycle = tVers.nCycle;		//nCycle = nCycleIcon;		++nCycle;				start.h = tLogo.end.h + tLogo.direct.h * nCycle * tLogo.nStep;		start.v = tLogo.end.v + tLogo.direct.v * nCycle * tLogo.nStep;		((AboutPix*)vpLogo)->setTrip( &start, &tLogo.end, tLogo.nStep );				start.h = tIcon.end.h + tIcon.direct.h * nCycle * tIcon.nStep;		start.v = tIcon.end.v + tIcon.direct.v * nCycle * tIcon.nStep;		((AboutPix*)vpIcon)->setTrip( &start, &tIcon.end, tIcon.nStep );				start.h = tPegasus.end.h + tPegasus.direct.h * nCycle * tPegasus.nStep;		start.v = tPegasus.end.v + tPegasus.direct.v * nCycle * tPegasus.nStep;		((AboutPix*)vpPegasus)->setTrip( &start, &tPegasus.end, tPegasus.nStep );				start.h = tVers.end.h + tVers.direct.h * nCycle * tVers.nStep;		start.v = tVers.end.v + tVers.direct.v * nCycle * tVers.nStep;		((AboutPix*)vpVers)->setTrip( &start, &tVers.end, tVers.nStep );				start.h = tCopy.end.h + tCopy.direct.h * nCycle * tCopy.nStep;		start.v = tCopy.end.v + tCopy.direct.v * nCycle * tCopy.nStep;		((AboutPix*)vpCopy)->setTrip( &start, &tCopy.end, tCopy.nStep );				result = YES;			} while ( 0 );		return result;}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/Bool	AboutAnim::moreFrames		(		){	Bool	result = YES;		do	{		if ( vpLogo->hasFrame( vnFrame+1 ) )			break;		if ( vpIcon->hasFrame( vnFrame+1 ) )			break;		if ( vpPegasus->hasFrame( vnFrame+1 ) )			break;		if ( vpCopy->hasFrame( vnFrame+1 ) )			break;		if ( vpVers->hasFrame( vnFrame+1 ) )			break;			result = NO;			} while ( 0 );		return result;}/*---------------------------------------------------------------------+\ *  NAME:	frameStart - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/Bool	AboutAnim::frameStart		(		){	Bool	result = NO;		::ForeColor( blackColor );	::BackColor( whiteColor );	result = moreFrames();		++vnFrame;	if ( result )		::EraseRect( &vRect );		return result;}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/Bool	AboutAnim::frameDrawSome		(		){	Bool	result = YES;		if ( vnIconFrame < vnFrame )	{		vpIcon->draw( &vRect, vnFrame );		vnIconFrame = vnFrame;		return YES;		// only draw one thing	}		if ( vnLogoFrame < vnFrame )	{		vpLogo->draw( &vRect, vnFrame );		vnLogoFrame = vnFrame;		return YES;	}		if ( vnPegasusFrame < vnFrame )	{		vpPegasus->draw( &vRect, vnFrame );		vnPegasusFrame = vnFrame;		return YES;	}		if ( vnCopyFrame < vnFrame )	{		vpCopy->draw( &vRect, vnFrame );		vnCopyFrame = vnFrame;		return YES;		// only draw one thing	}		if ( vnVersFrame < vnFrame )	{		vpVers->draw( &vRect, vnFrame );		vnVersFrame = vnFrame;		return YES;		// only draw one thing	}		return result;}/*---------------------------------------------------------------------+\ *  NAME:	frameComplete - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	20-Nov-1995\+---------------------------------------------------------------------*/Bool	AboutAnim::frameComplete		(		){	Bool	result = YES;		if ( vnIconFrame < vnFrame )	{		vpIcon->draw( &vRect, vnFrame );		vnIconFrame = vnFrame;	}		if ( vnLogoFrame < vnFrame )	{		vpLogo->draw( &vRect, vnFrame );		vnLogoFrame = vnFrame;	}		if ( vnPegasusFrame < vnFrame )	{		vpPegasus->draw( &vRect, vnFrame );		vnPegasusFrame = vnFrame;	}		if ( vnCopyFrame < vnFrame )	{		vpCopy->draw( &vRect, vnFrame );		vnCopyFrame = vnFrame;	}		if ( vnVersFrame < vnFrame )	{		vpVers->draw( &vRect, vnFrame );		vnVersFrame = vnFrame;	}		return result;}/*---------------------------------------------------------------------+\ *  NAME:	buildPix - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	28-Nov-1995\+---------------------------------------------------------------------*/XPSpritePixPtr		AboutAnim::buildPix		(		Point*	pDist,		short	nPictID		){	XPSpritePixPtr	pPix = NULL;	Rect			r;	Bool			result = NO;		do // sequence	{		pPix = new AboutPix;		if ( NULL == pPix )			break;		if ( ! pPix->specifyPicture( nPictID ) )			break;		if ( ! pPix->reset() )			break;		pPix->getRect( &r );		pDist->v = r.bottom - r.top;		pDist->h = r.right - r.left;				result = YES;			} while ( 0 ); // end sequence	if ( ! result )	{		if ( pPix )		{			delete pPix;			pPix = NULL;		}	}		return pPix;}/*---------------------------------------------------------------------+\ *  NAME:	buildVers - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	29-Nov-1995\+---------------------------------------------------------------------*/XPSpritePixPtr		AboutAnim::buildVers		(		Point*	pDist		){	XPSpritePixPtr	pPix = NULL;	Bool			result = NO;		Str255		apName;	short		apRefNum;	Handle		apParam;	short		resSaveFile;	char		sVersion[20];	Str255		pasVersion;	resSaveFile = CurResFile();	GetAppParms( apName, &apRefNum, &apParam );		UseResFile( apRefNum );	macVersion_getString( sVersion );	UseResFile( resSaveFile );		string_convPasFromC( pasVersion, sVersion );	string_pasConcat( apName, "\p  " );	string_pasConcat( apName, pasVersion );		return buildText( pDist, apName );}/*---------------------------------------------------------------------+\ *  NAME:	buildCopyRight - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	29-Nov-1995\+---------------------------------------------------------------------*/XPSpritePixPtr		AboutAnim::buildCopyRight		(		Point*	pDist		){	Str255		pasString;	string_pasCopy( pasString, "\p© 1997 Grizzly Software ($5 Shareware)" );	return buildText( pDist, pasString );}/*---------------------------------------------------------------------+\ *  NAME:	buildText - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	28-Nov-1995\+---------------------------------------------------------------------*/XPSpritePixPtr		AboutAnim::buildText		(		Point*		pDist,		StringPtr	pasString		){	XPSpritePixPtr	pPix = NULL;	Rect			r;	Bool			result = NO;		FontInfo	info;	short		nHeight;	short		nMaxWidth;	do // sequence	{		pPix = new AboutPixText;		if ( NULL == pPix )			break;		::TextFont( 0 );		::TextSize( 12 );		::TextFace( 0 );		::GetFontInfo( &info );		nHeight = info.ascent + info.descent + info.leading;		nMaxWidth = ::StringWidth( pasString );				pPix->makeGWorld( nMaxWidth, nHeight );		pPix->beginDrawing();		::TextFont( 0 );		::TextSize( 12 );		::TextFace( 0 );		::MoveTo( 0, info.ascent );		::DrawString( pasString );		pPix->endDrawing();				pPix->getRect( &r );		pDist->v = r.bottom - r.top;		pDist->h = r.right - r.left;				result = YES;			} while ( 0 ); // end sequence	if ( ! result )	{		if ( pPix )		{			delete pPix;			pPix = NULL;		}	}		return pPix;}#if 0____class____(){}#endifIMPL_StreamCreate( RemindAbout, INHERITED )#if 0_(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 RemindAbout - constructor *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/RemindAbout::RemindAbout		(		void		)		: INHERITED(){	initRemindAbout();}/*---------------------------------------------------------------------+\ *  NAME:	 ~RemindAbout - destructor *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/RemindAbout::~RemindAbout		(		void		){	if ( vpViewWorld )	{		delete vpViewWorld;		vpViewWorld = NULL;	}	if ( vpAnim )	{		delete vpAnim;		vpAnim = NULL;	}		XPApplication::enablePostedCommands();}/*---------------------------------------------------------------------+\ *  NAME:	 initRemindAbout - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/void	RemindAbout::initRemindAbout		(		void		){	vnState = 0;	vnStartTime = 0;	vbRepeating = NO;	vpViewWorld = NULL;	vpAnim = NULL;}/*=====================================================================+\||	 public member functions											|\+=====================================================================*/#if 0____public____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 createRemindAbout - static function *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	12-Sep-1995\+---------------------------------------------------------------------*/void	RemindAbout::createRemindAbout		(		void		){	LWindow*	pWind;	pWind = LWindow::CreateWindow( 5001, XPApplication::getApplicationPtr() );	if ( pWind )		pWind->UpdatePort();}/*=====================================================================+\||	 protected member functions											|\+=====================================================================*/#if 0____protected____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 finishAndClose - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/void	RemindAbout::finishAndClose		(		void		){	if ( vbRepeating )		StopRepeating();	else		StopIdling();	LWindow	*pWind = getLWindow();	if ( pWind )		pWind->DoClose();}/*---------------------------------------------------------------------+\ *  NAME:	 drawPict - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/void	RemindAbout::drawPict		(		void		){	vpViewWorld->BeginDrawing();		if ( 0 == vnState )		vpAnim->frameStart();		vpAnim->frameComplete();	vpViewWorld->EndDrawing();}/*---------------------------------------------------------------------+\ *  NAME:	 getLWindow - Get pointer to window's super commander *  DESCRIPTION:		This function walks up the super view list.  We assume that		when we find a super view that is null, that we have the window. *  AUTHOR: J.Griswold			DATE:	14-May-1995\+---------------------------------------------------------------------*/LWindow*		RemindAbout::getLWindow		(		void		){	return this;}Bool	RemindAbout::doFrame		(		){	Bool	bMore = YES;	Bool	result = YES;	Long	nDelta;		if ( 0 < vnStartTime )	{		nDelta = ::TickCount() - vnStartTime;		result = vpAnim->moreFrames();		if ( result )		{			if ( nDelta < 1 )			{				if ( 0 == vnState )				{					vpViewWorld->BeginDrawing();					result = vpAnim->frameStart();					vpViewWorld->EndDrawing();					vnState = 1;				}				else				{					vpViewWorld->BeginDrawing();					vpAnim->frameDrawSome();					vpViewWorld->EndDrawing();					vnState = 2;							}				return YES;			}			else			{				vnStartTime = 0;				drawPict();				Refresh();				getLWindow()->UpdatePort();				vnStartTime = ::TickCount();				vnState = 0;				//FocusDraw();				//drawPict();			}		}	}	else	{		nDelta = 0;		if ( 0 == vnStartTime )			vnStartTime = ::TickCount();	}	if ( ! result )	{		vnState = 100;		if ( nDelta > 60*20 )			bMore = NO;	}		return bMore;}/*=====================================================================+\||	 private member functions											|\+=====================================================================*/#if 0____private____(){}#endif/*=====================================================================+\||																		|||	 Overrides															|||																		|\+=====================================================================*/#if 0________Overrides________(){}#endif#if 0____LPane____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 FinishCreateSelf - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	09-Jul-1995\+---------------------------------------------------------------------*/void	RemindAbout::FinishCreateSelf		(		void		){	GDHandle		hMain;	int				nDepth;	SDimension16	size;	Rect			r;		INHERITED::FinishCreateSelf();	hMain = GetMainDevice();	nDepth = (**(**hMain).gdPMap).pixelSize;	GetFrameSize( size );	r.left = 0;	r.top = 0;	r.right = size.width;	r.bottom = size.height;	vpViewWorld = new LGWorld( r, nDepth, 0, 0, hMain );	vpAnim = new AboutAnim;	if ( vpAnim )	{		vpAnim->setSize( &r );		vpAnim->initialize();		vnState = 0;	}		if ( IsVisible() )	{		Refresh();		getLWindow()->UpdatePort();	}	//StartRepeating();	StartIdling();	vbRepeating = NO;}/*---------------------------------------------------------------------+\ *  NAME:	 DrawSelf - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/void	RemindAbout::DrawSelf		(		void		){	Rect			rView;	SDimension16	size;	GrafPtr			pViewPort;	CGrafPtr		pCPort;	GWorldPtr		pGWorld;	long			ctSeedSave;	INHERITED::DrawSelf();		if ( 0 == vnStartTime )		vnStartTime = ::TickCount();			GetFrameSize( size );	rView.left = 0;	rView.top = 0;	rView.right = size.width;	rView.bottom = size.height;			::GetPort( &pViewPort );	pCPort = (CGrafPtr)pViewPort;	//::ForeColor( blackColor );	//::BackColor( whiteColor );	ctSeedSave = (*(*pCPort->portPixMap)->pmTable)->ctSeed;	pGWorld = vpViewWorld->GetMacGWorld();	(*(*pCPort->portPixMap)->pmTable)->ctSeed			= (*(*pGWorld->portPixMap)->pmTable)->ctSeed;	//long nTicks = LMGetTicks();	//while ( nTicks == LMGetTicks() )	//	; // noop	vpViewWorld->CopyImage( pViewPort, rView );	(*(*pCPort->portPixMap)->pmTable)->ctSeed = ctSeedSave;	vnState = 0;}/*---------------------------------------------------------------------+\ *  NAME:	 ClickSelf - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/void	RemindAbout::ClickSelf		(		const SMouseDownEvent	&inMouseDown		){	INHERITED::ClickSelf( inMouseDown );	finishAndClose();}#if 0____LWindow____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 HandleClick - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	02-Jan-1996\+---------------------------------------------------------------------*/void	RemindAbout::HandleClick		(		const EventRecord&	inMacEvent,		Int16				inPart		){	if ( click_OutsideModal == inPart )		finishAndClose();	else		INHERITED::HandleClick( inMacEvent, inPart );}#if 0____LCommander____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 FindCommandStatus - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	01-Jan-1996\+---------------------------------------------------------------------*/void	RemindAbout::FindCommandStatus		(		CommandT	inCommand,		Boolean		&outEnabled,		Boolean		&outUsesMark,		Char16		&outMark,		Str255		outName		){	outUsesMark = false;	outEnabled = false;	#if 1	switch ( inCommand )	{	case cmd_About:		outEnabled = false;		break;			default:		INHERITED::FindCommandStatus( inCommand, outEnabled,										outUsesMark, outMark, outName );		break;	}#endif}/*---------------------------------------------------------------------+\ *  NAME:	 ObeyCommand - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	02-Jan-1996\+---------------------------------------------------------------------*/Boolean	RemindAbout::ObeyCommand		(		CommandT	inCommand,		void		*ioParam		){	finishAndClose();	return INHERITED::ObeyCommand( inCommand, ioParam );}/*---------------------------------------------------------------------+\ *  NAME:	HandleKeyPress - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	29-Nov-1995\+---------------------------------------------------------------------*/Boolean	RemindAbout::HandleKeyPress		(		const EventRecord	&inKeyEvent		){	UNREFERENCED_PARAMETER( inKeyEvent );		finishAndClose();	return true;}#if 0____LPeriodical____(){}#endif/*---------------------------------------------------------------------+\ *  NAME:	 SpendTime - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	30-Jun-1995\+---------------------------------------------------------------------*/void	RemindAbout::SpendTime		(		const EventRecord &inMacEvent		){	long	nDelta = 0;	Bool	result = YES;		UNREFERENCED_PARAMETER( inMacEvent );		if ( ! vbRepeating )	{		StopIdling();		StartRepeating();		vbRepeating = YES;		if ( 0 == vnState )		{			vpViewWorld->BeginDrawing();			vpAnim->frameStart();			vpViewWorld->EndDrawing();			vnState = 1;		}		else		{			vpViewWorld->BeginDrawing();			vpAnim->frameDrawSome();			vpViewWorld->EndDrawing();			vnState = 2;					}		return;	}	else	{		if ( vnState < 100 )		{			EventRecord		ev;						do			{				if ( ! doFrame()  ||  Button() )				{					finishAndClose();					break;				}			} while ( vnState < 100					&&  ! ::EventAvail( everyEvent, &ev ) );		}		else		{			nDelta = ::TickCount() - vnStartTime;			if ( nDelta > 60*20  ||  Button() )				finishAndClose();		}	}}/*---------------------------------------------------------------------+\ *  NAME:	someFunction - brief statement *  DESCRIPTION: *  AUTHOR: J.Griswold			DATE:	dd-mmm-1995\+---------------------------------------------------------------------*/